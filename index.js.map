{"version":3,"file":"index.js","sources":["../src/js/api-fetch.js","../src/js/render-markup.js","../src/js/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function fetchToApiMovie(page, endPoint, movieName, year) {\n    const baseURL = 'https://api.themoviedb.org/3';\n    const endPointEl = endPoint;\n    \n    const params = {\n        page: page,\n        api_key: 'd3a8d2b8dd7d39a12f23ee17ed71c787',\n    }\n    if (movieName) {\n        params.query = movieName;\n        params.year = year;\n  }\n    const url = baseURL + endPointEl;\n    const res = await axios.get(url, {params});\n    return res.data;\n}","export function renderMovieCard(data = [], favMovie=[] ) {\n  const markup = data.map(({ original_title, poster_path, release_date, overview, vote_average, vote_count, id }) => {\n      const isFavorite = favMovie.some(fav => fav.id === id);\n    return `<li class=\"movie-card\">\n            <img \n    src=\"https://image.tmdb.org/t/p/w300/${poster_path}\" \n    alt=\"War of the Worlds Poster\" \n    class=\"movie-poster\"\n  />\n  <div class=\"movie-info\">\n    <h2 class=\"movie-title\">${original_title} <span class=\"movie-year\">${release_date}</span></h2>\n    <div class=\"movie-stats\">\n      <span class=\"movie-rating\">‚≠ê ${vote_average}</span>\n      <span class=\"movie-popularity\">üî• ${vote_count}</span>\n      </div>\n            <button class=\"btn-see-more-mov\" data-id=\"${id}\" >See more</button>\n      <button class=\"btn-favor-mov\" data-id=\"${id}\" data-action=\"${isFavorite ? 'delete' : 'add'}\" >${isFavorite ? 'Delete from Favorite' : 'Add to Favorite' }</button>\n          </li>`\n    \n  }).join('\\n');\n    return markup;\n}\n\nexport function renderModalForMovie({ poster_path,title, genres, vote_average, vote_count, overview,release_date,production_countries }, trailer, {cast}) {\n  const genresList = genres.map(el => el.name).join(', ');\n  const rating = `‚≠ê ${vote_average?.toFixed(1)}<br>Votes: üî• ${vote_count}`;\n  const year = release_date.slice(0, 4);\n  const country = production_countries.map(el => el.name).join(', ');\n  const trailerKey = trailer.results[0].key;\n  const actorMarkup = cast.slice(0,8).map(({ profile_path, name, character }) => `<li class=\"actor-card\">\n          <img src=\"https://image.tmdb.org/t/p/w200${profile_path}\" alt=\"${name}\" class=\"actor-img\" />\n          <p class=\"actor-name\">${name}</p>\n          <p class=\"actor-role\">as ${character}</p>\n        </li>`).join('\\n');\n  \n  return `<div class=\"modal-poster\">\n            <img id=\"modal-poster\" src=\"https://image.tmdb.org/t/p/w300/${poster_path}\" alt=\"Poster\" />\n          </div>\n          <div class=\"modal-info\">\n            <h2 id=\"modal-title\">Name: ${title}</h2>\n            <p id=\"modal-genres\">Country: ${country}</p>\n            <p id=\"modal-genres\">Genres: ${genresList}</p>\n            <p id=\"modal-rating\">Rating: ${rating}</p>\n            <p id=\"modal-year\">Year: ${year}</p>\n            <p id=\"modal-overview\">Description:<br>${overview}</p>\n          </div>\n          <div id=\"modal-trailer\" class=\"trailer\">\n            <iframe  src=\"https://www.youtube.com/embed/${trailerKey}\" title=\"Movie trailer\"  allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen> </iframe>\n            </div>\n            <h3>Actors</h3>\n            <ul id=\"modal-actors\" class=\"actors-list\">${actorMarkup}</ul>\n            <button id=\"modal-fav-btn\" class=\"fav-btn\">Add to Favorites</button>\n          `\n}\n\nexport function showBtnLoadMore(loadMoreEl) {\n  loadMoreEl.classList.remove('hidden')\n}\nexport function hideBtnLoadMore(loadMoreEl) {\n  loadMoreEl.classList.add('hidden')\n}\nexport function openModalDescription(el) {\n  el.classList.remove('hidden');\n  document.body.classList.add('modal-open');\n\n}\nexport function closeModalDescription(el) {\n  el.classList.add('hidden');\n  const trailerContainer = document.querySelector('#modal-trailer');\n  trailerContainer.innerHTML = '';\n  document.body.classList.remove('modal-open');\n\n}","import { fetchToApiMovie } from './api-fetch';\nimport {\n  closeModalDescription,\n  hideBtnLoadMore,\n  openModalDescription,\n  renderModalForMovie,\n  renderMovieCard,\n  showBtnLoadMore,\n} from './render-markup';\n\nconst moviesList = document.querySelector('.movies-list');\nconst loadMoreEl = document.querySelector('#load-more');\nconst favoritesListEl = document.querySelector('.favorites-list');\nconst foundmovieEl = document.querySelector('.found-movie');\nconst moviesTitle = document.querySelector('.movies-popular-title');\nconst btnPopularMovie = document.querySelector('.btn-popular-movie');\nconst favoriteTitleBtn = document.querySelector('.btn-favorites-movie');\nconst modalEl = document.querySelector('.modal');\nconst modalCloseEl = document.querySelector('.modal-close');\nconst modalBodyEl = document.querySelector('.modal-body');\n\nlet page;\nlet maxPage;\nlet movieArray = [];\nlet currentMode = 'popular';\nlet currentQueryName = '';\nlet currentYear = '';\n\nconst getLocalFavMovie = localStorage.getItem('favoriet Movie');\nlet favMovie = getLocalFavMovie ? JSON.parse(getLocalFavMovie) : [];\n\nrenderFavMovieCard();\n\n// Click to fetch the popular movie\ndocument.addEventListener('DOMContentLoaded', async () => {\n  loadPopularMovies();\n});\nbtnPopularMovie.addEventListener('click', async () => {\n  loadPopularMovies();\n});\nasync function loadPopularMovies() {\n  currentMode = 'popular';\n  page = 1;\n  moviesTitle.textContent = 'Popular Movies';\n  try {\n    const res = await fetchToApiMovie(page, '/movie/popular');\n    const markup = renderMovieCard(res.results, favMovie);\n    moviesList.innerHTML = markup;\n    maxPage = res.total_pages;\n    movieArray.push(...res.results);\n  } catch {\n    console.log('Error');\n  } finally {\n    checkLoadMoreViseble();\n  }\n}\n\n// Click to Btn Load more popular movie\nloadMoreEl.addEventListener('click', async () => {\n  if (currentMode === 'popular') {\n    loadMoreMovie('/movie/popular');\n  } else {\n    loadMoreMovie('/search/movie', currentQueryName, currentYear);\n  }\n});\nfunction checkLoadMoreViseble() {\n  if (page < maxPage) {\n    showBtnLoadMore(loadMoreEl);\n  } else {\n    hideBtnLoadMore(loadMoreEl);\n  }\n}\n\nasync function loadMoreMovie(endPoint, queryName, year) {\n  page += 1;\n  try {\n    const res = await fetchToApiMovie(page, endPoint, queryName, year);\n    const markup = renderMovieCard(res.results, favMovie);\n    moviesList.insertAdjacentHTML('beforeend', markup);\n    movieArray.push(...res.results);\n  } catch {\n    console.log('Error');\n  }\n  checkLoadMoreViseble();\n}\n// Find the movie\n\nfoundmovieEl.addEventListener('submit', async e => {\n  e.preventDefault();\n  page = 1;\n\n  moviesTitle.textContent = 'Found movies';\n  const inputNameValue = e.target.elements.movieName.value.trim();\n  const inputYearValue = e.target.elements.movieYear.value.trim();\n  if (inputNameValue === '') return;\n  try {\n    const res = await fetchToApiMovie(\n      1,\n      '/search/movie',\n      inputNameValue,\n      inputYearValue\n    );\n    const markup = renderMovieCard(res.results, favMovie);\n    movieArray = res.results;\n    maxPage = res.total_pages;\n    moviesList.innerHTML = markup;\n  } catch {\n    console.log('Error');\n  }\n  currentMode = 'search';\n  currentQueryName = inputNameValue;\n  currentYear = inputYearValue;\n  checkLoadMoreViseble();\n  e.target.reset();\n});\n\n// Click Btn to add in Favorite\nmoviesList.addEventListener('click', async e => {\n  const btnAddFav = e.target.closest('.btn-favor-mov');\n  const btnSeeMore = e.target.closest('.btn-see-more-mov');\n  if (btnAddFav) {\n    const movieId = +btnAddFav.dataset.id;\n    const action = btnAddFav.dataset.action;\n    if (action === 'add') {\n      const foundMovie = movieArray.find(movie => movie.id == movieId);\n      const isMovieAlreadySelected = favMovie.some(\n        movie => movie.id == movieId\n      );\n      if (isMovieAlreadySelected) return;\n      favMovie.push(foundMovie);\n      changeBtnTextContent('delete', movieId);\n      renderFavMovieCard();\n      localStorage.setItem('favoriet Movie', JSON.stringify(favMovie));\n    } else if (action === 'delete') {\n      favMovie = favMovie.filter(movie => movie.id !== movieId);\n      changeBtnTextContent('add', movieId);\n      renderFavMovieCard();\n      localStorage.setItem('favoriet Movie', JSON.stringify(favMovie));\n    }\n    return;\n  }\n  if (btnSeeMore) {\n    const movieId = +btnSeeMore.dataset.id;\n    const res = await fetchToApiMovie(1, `/movie/${movieId}`);\n    const trailerMovie = await fetchToApiMovie(1, `/movie/${movieId}/videos`);\n    const actorsMovie = await fetchToApiMovie(1, `/movie/${movieId}/credits`);\n    console.log(actorsMovie);\n    const markup = renderModalForMovie(res, trailerMovie, actorsMovie);\n    modalBodyEl.innerHTML = markup;\n    openModalDescription(modalEl);\n    return;\n  }\n});\n\nmodalCloseEl.addEventListener('click', () => {\n  closeModalDescription(modalEl);\n});\n\nfavoritesListEl.addEventListener('click', e => {\n  const btn = e.target.closest('button');\n  if (!btn) return;\n  const movieId = +btn.dataset.id;\n  favMovie = favMovie.filter(movie => movie.id !== movieId);\n  localStorage.setItem('favoriet Movie', JSON.stringify(favMovie));\n  renderFavMovieCard();\n  changeBtnTextContent('add', movieId);\n});\nfavoriteTitleBtn.addEventListener('click', () => {\n  const favoritesSection = document.getElementById('favorites-section');\n  favoritesSection.scrollIntoView({ behavior: 'smooth' });\n});\nfunction changeBtnTextContent(action, movieId) {\n  const btn = document.querySelector(\n    `.movies-list .btn-favor-mov[data-id=\"${movieId}\"]`\n  );\n  if (btn) {\n    if (action === 'add') {\n      btn.dataset.action = 'add';\n      btn.textContent = 'Add to Favorite';\n    } else {\n      btn.dataset.action = 'delete';\n      btn.textContent = 'Delete from Favorite';\n    }\n  }\n}\nfunction renderFavMovieCard() {\n  const markup = renderMovieCard(favMovie, favMovie);\n  favoritesListEl.innerHTML = markup;\n}\n"],"names":["fetchToApiMovie","page","endPoint","movieName","year","baseURL","endPointEl","params","url","axios","renderMovieCard","data","favMovie","original_title","poster_path","release_date","overview","vote_average","vote_count","id","isFavorite","fav","renderModalForMovie","title","genres","production_countries","trailer","cast","genresList","el","rating","country","trailerKey","actorMarkup","profile_path","name","character","showBtnLoadMore","loadMoreEl","hideBtnLoadMore","openModalDescription","closeModalDescription","trailerContainer","moviesList","favoritesListEl","foundmovieEl","moviesTitle","btnPopularMovie","favoriteTitleBtn","modalEl","modalCloseEl","modalBodyEl","maxPage","movieArray","currentMode","currentQueryName","currentYear","getLocalFavMovie","renderFavMovieCard","loadPopularMovies","res","markup","checkLoadMoreViseble","loadMoreMovie","queryName","inputNameValue","inputYearValue","btnAddFav","btnSeeMore","movieId","action","foundMovie","movie","changeBtnTextContent","trailerMovie","actorsMovie","btn"],"mappings":"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"}